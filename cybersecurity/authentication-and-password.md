# การยืนยันตัวตนและรหัสผ่าน

รหัสผ่านเป็นเครื่องมือที่อยู่กับโลกออนไลน์มายาวนาน และปฏิเสธไม่ได้ว่าเป็นหนึ่งในเป้าหมายการโจมตี การขโมยรหัสผ่านหมายถึงการขโมยตัวตนบนโลกออนไลน์ ตั้งแต่บัญชีสื่อสังคมออนไลน์จนถึงการทำธุรกรรมที่เกี่ยวข้องกับการเงิน

แต่รหัสผ่านไม่ใช่วิธีเดียวที่เราสามารถใช้ยืนยันตัวตนบนโลกออนไลน์ บทความนี้จะพูดถึงกระบวนการยืนยันตัวตนและการใช้รหัสผ่านเพื่อให้เกิดความปลอดภัยสูงสุดกับผู้ใช้

## รหัสผ่าน

เราอาจจะรู้สึกว่ากลไกของรหัสผ่านไม่ซับซ้อน อย่างไรก็ตาม เคยสงสัยหรือไม่ว่า

- ผู้ใช้บริการรู้รหัสผ่านของเราหรือเปล่า
- มีโอกาสหรือไม่ที่ผู้ประสงค์ร้ายซึ่งทำงานในบริษัทของผู้ให้บริการ จะขโมยรหัสผ่านของเราไปใช้กับที่อื่น

เราจำเป็นต้องพูดถึงวิธีการที่ระบบต่างๆ เก็บรหัสผ่านกันโดยคร่าวเล็กน้อย

### Hashing - การเก็บ "ตัวแทน" ของรหัสผ่าน

![image](https://user-images.githubusercontent.com/3682634/103720880-f07ddd00-4ffe-11eb-8e5f-9cca20eb887d.png)

เมื่อเราสมัตรบริการอะไรก็ตาม ผู้ให้บริการจะนำรหัสผ่านของเราที่เรากรอก ไปผ่าน "กล่องมหัศจรรย์" จนออกมาเป็นอักษรอะไรบางอย่าง และเก็บอักษรชุดนั้นเป็น "ตัวแทน" ของรหัสผ่าน ไม่ได้เก็บรหัสผ่านของเรา

![image](https://user-images.githubusercontent.com/3682634/103721297-e7d9d680-4fff-11eb-8bc1-6e5f5c03014c.png)

สิ่งที่ทำให้กลไกของ "กล่องมหัศจรรย์" ปลอดภัยคือ__กล่องมหัศจรรย์สามารถใช้เปลี่ยนรหัสผ่านที่เราพิมพ์เป็นค่าตัวแทนได้ แต่จะไม่สามารถเปลี่ยนตัวแทนกลับไปเป็นรหัสผ่านได้__ การกระทำเช่นนี้ทำให้เรามั่นใจได้สองอย่าง: ผู้ให้บริการเว็บไซต์ไม่สามารถเห็นรหัสผ่านจริงๆ ของเราได้ และในกรณีที่รหัสผ่านของเรารั่ว สิ่งที่รั่วคือตัวแทนของรหัสผ่าน ไม่ใช่รหัสผ่านจริงๆ

ในกรณีที่รหัสผ่านที่เป็นข้อความของเรารั่วขึ้นมา ผู้ประสงค์ร้ายสามารถนำรหัสผ่านของเราไปเข้าใช้บริการอื่นๆ ได้ แต่หากรหัสผ่านอยู่ในรูปแบบของ "ตัวแทน" และไม่สามารถถอดกลับออกมาเป็นรหัสผ่านตั้งต้นได้ ก็ย่อมไม่สามารถนำไปใช้กับบริการอื่นได้เช่นกัน

![image](https://user-images.githubusercontent.com/3682634/104031953-06a6bb80-5200-11eb-8e90-553c2a1ceb89.png)

ชื่ออย่างเป็นทางการของกล่องมหัศจรรย์คือ __hash function__ และเราเรียกค่าตัวแทนที่ออกมาจาก hash function ว่า __digest__

### Rainbow table - ตารางโกงกระบวนการเก็บรหัสผ่าน

เพราะเรารู้ว่าการเปลี่ยนรหัสผ่านเป็นตัวแทนสามารถทำได้ แต่ไม่สามารถเปลี่ยนตัวแทนของรหัสผ่านเป็นอะไร ดังนั้นหากเราถามว่ารหัสผ่านอะไรที่เมื่อใส่ในกล่องมหัศจรรย์แล้วจะได้ออกมาเป็น `03cfd743661f07975fa2f1220c5194cbaff48451` ก็ควรจะตอบไม่ได้

จริงหรือเปล่า?

![image](https://user-images.githubusercontent.com/3682634/104032762-330f0780-5201-11eb-83c4-76887847d0fc.png)

ในทางปฏิบัติ เราสามารถค่อยๆ เอารหัสผ่านใส่เข้าไปในกล่องทีละตัว เริ่มตั้งแต่ a, b, c, ... ไล่ไปเรื่อยๆ แล้วเก็บประวัติไว้ว่าค่าตัวแทนค่าหนึ่งได้มาจากการเอารหัสผ่านใดไปใส่ในกล่องมหัศจรรย์

![image](https://user-images.githubusercontent.com/3682634/104033071-9f8a0680-5201-11eb-88dc-7e1d245ae81d.png)

เราเรียกตารางที่เก็บค่าในลักษณะนี้ว่า __rainbow table__ และจะสังเกตเห็นได้ว่า หากรหัสผ่านของเราไม่อยู่ในข้อความที่ผู้สร้าง rainbow table ก็จะไม่สามารถถอดกลับจากตัวแทนรหัสผ่านออกมาเป็นรหัสผ่านจริงๆ ได้

![image](https://user-images.githubusercontent.com/3682634/104033657-6605cb00-5202-11eb-8e82-75c80f49c171.png)

เหตุผลหลักที่เราตั้งรหัสผ่านให้ไม่ซ้ำกับรหัสผ่านที่ผู้อื่นใช้อยู่ คือ__เพื่อลดโอกาสที่รหัสผ่านที่เราใช้จะไปอยู่ใน rainbow table__ ภาพข้างต้นทดลองนำตัวแทนรหัสผ่านไปค้นหารหัสผ่านตั้งต้นบนบริการ rainbow table บนเว็บไซต์ https://crackstation.net/ จะสังเกตได้ว่าสามในห้าของรหัสผ่านคือ `password`, `P@ssw0rd` และ `P@ssw0rd!` ซึ่งเป็นรหัสผ่านที่มีการใช้ซ้ำจำนวนมาก

รหัสผ่านสองรหัสผ่านที่เหลือ (ที่ไม่พบใน rainbow table) คือ `P@ssw0rd!!!` และ `B5jYH5zsLc35$8z^` ตามลำดับ จะเห็นว่า__ใจความของการตั้งรหัสให้มีตังอักษรพิเศษต่างๆ คือเพื่อลดโอกาสที่รหัสผ่านของเรา (และตัวแทน) จะไปอยูใน rainbow table__

### เราไม่รู้ว่าผู้ใช้บริการเก็บรหัสผ่านของเราอย่างไร

ผู้ใช้บริการออนไลน์อาจจะรู้สึกอุ่นใจว่าการเก็บรหัสผ่านแบบเป็นตัวแทน จะทำให้รหัสผ่านของตัวเองปลอดภัย __แต่ในความเป็นจริงแล้วไม่ใช่บริการทุกบริการเก็บรหัสผ่านอย่างปลอดภัย__

- บริการออนไลน์หลายบริการเก็บรหัสผ่านตรงๆ โดยไม่นำไปผ่านกล่องมหัศจรรย์ หากรหัสผ่านรั่ว ผู้ประสงค์ร้ายจะนำไปล็อกอินเว็บไซต์อื่นได้ทันที
- เรามักนำค่าบางอย่างซึ่งเป็นค่าไม่ซ้ำกันในทุกผู้ใช้ ต่อท้ายรหัสผ่านก่อนทำไปผ่านกล่องมหัศจรรย์ เพื่อให้ผลลัพธ์จากกล่องไม่ซ้ำกัน (ค่านี้เรียกว่า salt) อย่างไรก็ตาม บริการออนไลน์บางบริการอาจจะไม่ได้ใช้กระบวนการดังกล่าว ทำให้ผู้ประสงค์ร้ายสามารถเห็นได้ว่าผู้ใช้คนใดใช้รหัสผ่านเดียวกันบ้าง
- กล่องมหัศจรรย์ที่ดี ควรใช้เวลาประมวลผลนานเพื่อประวิงเวลาที่ใช้ในการคำนวนตาราง rainbow table อย่างไรก็ตามไม่ใช่ทุกผู้ให้บริการที่ใช้กล่องมหัศจรรย์ที่ดี ในกรณีนี้ผู้ประสงค์ร้ายอาจสามารถสร้างตาราง rainbow table ใหม่ได้อย่างรวดเร็ว หรือใช้ตารางที่มีอยู่แล้ว

ดังนั้น วิธีการใช้รหัสผ่านที่ดีที่สุด คือ __ใช้รหัสผ่านไม่ซ้ำกันในทุกบริการ__ แม้จะดูยากที่จะจำรหัสผ่านทั้งหมด แต่เรามีบริการที่จะช่วยในการจำรหัสผ่านได้อย่างปลอดภัย

## ตัวจัดการรหัสผ่าน

หลายคนอาจจะเคยจดรหัสผ่านไว้ในสมุด หรือแปะไว้กับกระดาษโน้ตบนจอ ตัวจัดการรหัสผ่านทำหน้าที่คล้ายๆ กับสองอย่างที่ว่ามา แต่ว่าเปลี่ยนเป็นแอปแค่นั้น

![image](https://user-images.githubusercontent.com/3682634/106973491-84210580-6785-11eb-962e-f0ed2e0e819b.png)

พูดง่ายๆ คือเราจับรหัสผ่านของทุกบริการใส่ไว้ใน "กล่องล็อก" ซึ่งก็คือตัวจัดการรหัสผ่าน (password manager) เวลาจะใช้รหัสผ่านของแต่ละบริการ ก็แค่เปิดกล่องด้วยรหัสผ่านของตัวจัดการรหัสผ่าน (ซึ่งมักจะเรียกว่า "master password" หรือ "รหัสผ่านหลัก") แล้วค่อย "ก็อปปี้" รหัสผ่านตรงนั้นไปเข้าใช้บริการอื่นอีกที

### เดี๋ยวนะ

มาถึงจุดนี้ ผู้อ่านหลายคนอาจจะสงสัยว่า "เดี๋ยวนะ สรุปก็คือที่บอกว่าให้ใช้รหัสผ่านไม่ซ้ำกันแต่ละบริการ สุดท้ายก็เอารหัสผ่านที่ไม่ซ้ำกันไปเก็บไว้ด้วยกันที่เดียวที่เข้าถึงได้ด้วยรหัสผ่านหลักตัวเดียวหนะเหรอ" พร้อมกับกังวลหรือสงสัยว่าจะต่างจากการใช้รหัสผ่านเดียวกันนั้นทุกบริการอย่างไร

![image](https://user-images.githubusercontent.com/3682634/106973758-1923fe80-6786-11eb-9886-061a3e65a9f9.png)

เวลาเราออกจากบ้าน เราไม่ล็อกบ้านเลย หรือว่าเราล็อกบ้านด้วยกุญแจสองร้อยดอก? คำตอบคือไม่ใช่ทั้งคู่ เพราะอย่างหนึ่งสะดวกแต่ไม่ปลอดภัย และอย่างหนึ่งปลอดภัยแต่ไม่สะดวก

![image](https://user-images.githubusercontent.com/3682634/106974252-fcd49180-6786-11eb-96da-154773839235.png)

การใช้ตัวจัดการรหัสผ่านก็เช่นกัน--เราได้รับความปลอดภัยจากการที่บริการต่างๆ ใช้รหัสผ่านไม่ซ้ำกัน เพราะหากรหัสในกล่องตัวใดตัวหนึ่งหลุดออกไป ก็ยังปลอดภัยอยู่ เพราะถ้ารหัสไม่ซ้ำกันก็ไม่สามารถนำไปเข้าใช้บริการอื่นๆ รวมถึงตัวจัดการรหัสผ่านได้ และความสะดวกจากการที่หากผู้ใช้อยากได้รหัสผ่านตัวเอง เพียงแค่ใช้รหัสผ่านหลักในการเข้าตัวจัดการรหัสผ่าน ก็จะเข้าถึงได้ทุกบริการ

การได้มาซึ่งความปลอดภัยนี้มีเงื่อนไขคือ (1) __รหัสผ่านทุกรหัส รวมถึงรหัสที่ใช้เปิดเข้าตัวจัดการรหัสผ่าน ไม่ซ้ำกันเลย__ และ (2) __รหัสผ่านที่ใช้เข้าตัวจัดการรหัสผ่านแข็งแรงพอ__ ไม่ใช่ใครก็เปิดดูรหัสผ่านอื่นๆ ในตัวจัดการรหัสผ่านได้

### แนะนำบริการตัวจัดการรหัสผ่าน

มีบริษัทจำนวนมากเปิดให้บริการตัวจัดการรหัสผ่าน หลายบริษัทมีรายได้จากการขายตัวจัดการรหัสผ่านเวอร์ชั่นเสียเงิน และขายให้องค์กรขนาดใหญ่

ณ เวลาที่เขียน (กุมภาพันธ์ 2021) เว็บไซต์ [PrivacyTools.io](https://privacytools.io/software/passwords/) แนะนำตัวจัดการรหัสผ่านไว้สามตัว หนึ่งในนั้นคือ [Bitwarden](https://bitwarden.com/) ที่ใช้งานได้ง่ายที่สุด และมีฟังก์ชันการซิงก์ (sync) รหัสผ่านข้ามเครื่องอัตโนมัติ

![image](https://user-images.githubusercontent.com/3682634/106974917-1fb37580-6788-11eb-8887-7729d0a43c68.png)

โดยปกติตัวจัดการรหัสผ่านจะมีส่วนเสริมสำหรับเบราเซอร์ เพียงติดตั้ง สมัคร และเข้าใช้บริการ เมื่อทยอยเพิ่มรหัสผ่านลงในตัวจัดการรหัสผ่านแล้ว การล็อกอินเข้าบริการต่างๆ จะเหลือเพียงแค่การเลือกรหัสผ่านที่ต้องการใช้เท่านั้น

ขั้นตอนที่ยากที่สุดของการเปลี่ยนมาใช้ตัวจัดการรหัสผ่าน คือการทยอยเปลี่ยนรหัสผ่านที่ใช้อยู่กับบริการต่างๆ ซ้ำๆ ให้เป็นรหัสผ่านใหม่ แต่เมื่อทยอยเปลี่ยนจนครบ ก็จะมั่นใจได้ถึงความปลอดภัยเพิ่มอีกขั้นหนึ่ง
